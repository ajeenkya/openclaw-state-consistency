{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://openclaw.local/schemas/signal_event.schema.json",
  "title": "SignalEvent",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "signal_id",
    "event_ts",
    "source",
    "entity_id",
    "items"
  ],
  "properties": {
    "signal_id": {
      "type": "string",
      "format": "uuid"
    },
    "event_ts": {
      "type": "string",
      "format": "date-time"
    },
    "source": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "kind",
        "mode",
        "ref"
      ],
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "calendar",
            "email"
          ]
        },
        "mode": {
          "type": "string",
          "enum": [
            "poll",
            "webhook"
          ]
        },
        "ref": {
          "type": "string",
          "minLength": 3,
          "maxLength": 300
        }
      }
    },
    "entity_id": {
      "type": "string",
      "pattern": "^(user|family|team):[a-z0-9._-]+$",
      "minLength": 3,
      "maxLength": 80
    },
    "items": {
      "type": "array",
      "minItems": 1,
      "maxItems": 100,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "domain",
          "field",
          "value"
        ],
        "properties": {
          "domain": {
            "type": "string",
            "enum": [
              "travel",
              "family",
              "project",
              "financial",
              "profile",
              "school",
              "general"
            ]
          },
          "field": {
            "type": "string",
            "pattern": "^[a-z0-9_.-]+$",
            "minLength": 3,
            "maxLength": 100
          },
          "ref": {
            "type": "string",
            "minLength": 2,
            "maxLength": 300
          },
          "value": {
            "oneOf": [
              {
                "type": "string",
                "maxLength": 5000
              },
              {
                "type": "number"
              },
              {
                "type": "boolean"
              },
              {
                "type": "null"
              },
              {
                "type": "array"
              },
              {
                "type": "object"
              }
            ]
          },
          "intent": {
            "type": "string",
            "enum": [
              "assertive",
              "planning",
              "historical"
            ],
            "default": "assertive"
          },
          "corroborators": {
            "type": "array",
            "maxItems": 10,
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "type",
                "ref"
              ],
              "properties": {
                "type": {
                  "type": "string",
                  "minLength": 2,
                  "maxLength": 60
                },
                "ref": {
                  "type": "string",
                  "minLength": 2,
                  "maxLength": 300
                }
              }
            }
          }
        }
      }
    }
  }
}
